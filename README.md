Node Shooter

Абстракт
Node Shooter е проста 2D шуутър игра с множество играчи и малко правила. 
За създаването на играта използвахме езика JavaScript и библиотеката NodeJS.
Основното правило в играта гласи „убий или умри“ - поставихме си за цел в началото да се придържаме към базисни елементи от shooting жанра, а в бъдеще да добавим допълнителни възможности.


	Node Shooter is a simple 2D multi-player game with only a few rules.
	For the creation of the game we used JavaScript and the library NodeJS. The main theme in the game is “Kill or be killed“ - we tried to keep the most simple elements of the shooter genre and, in the future, to add additional features.

Authors:
Victor Terziev, Sofia High School of Mathematics, Sofia, 8th grade
Stanislav Nikolov, Sofia High School of Mathematics, Sofia, 6th grade

Advisor:
Hristo Stoyanov, Sofia High School of Mathematics, student, 11th grade
1. Въведение

Целта на нашия проект е да създадем изчистена и интересна игра с просто управление и дизайн. Ние ще постигнем това като изградим основите на играта и на по-късен етап я доразвием и подобрим. Смятаме, че е възможно с подходяща физична симулация и семпло графично представяне да се постигне нещо много приятно за игра. За сега играчите имат възможност да се разхождат в малка и проста карта, притежавайки единствено слабо оръжие, с което се бият срещу останалите. Целта на всеки играч е да оцелее възможно най-дълго.

2. Техническо описание
2.1. Използвани технологии

За да постигнем всичко описано по-горе избрахме JavaScript[1], библиотеката NodeJS[2] и някои добавки (модули) към него. Причините за този избор са, че се поддържа от множество софтуерни и хардуерни платформи, върви директно в браузъра и не е необходимо инсталирането на допълнителен софтуер. NodeJS е библиотеката, с която създаваме сървъра, и съответно установяваме връзката между него и потребителя.

Модулите които използваме са “socket.io“[3] и “express“[4].  Първият е за да използваме сокети(sockets) в кода си. Това са тунели, чрез които потребителя установява комуникира със сървъра. На базата на тях сме създали система, която ни позволява ефективното прехвърляне на информация относно състоянието на играчите и играта. По-подробно описание може да се намери в §4.1.

Вторият модул, а именно - “express“ е минималистичен и гъвкав уеб framework за nodejs, който позволява лесното създаване на динамични страници. Основната цел при избора му беше улесняването на бъдещото развитие на играта по отношение на добавянето на акаунти, различни карти, предмети и други.

2.2. Gameplay 

Друга важна част беше геометрията. Тя трябваше да е лесна за схващане както и самата игра, но да бъде и реалистична. Фигурите в играта са окръжности, защото така достатъчно добре се пресъздава комбинацията от простота и елегантност. Движението е нестандартно - играчите могат само да се завъртат и да вървят напред. Друга възможност на играчите е да стрелят, разбира се, което също е максимално изчистено.

Трябва и да отбележим основните методи на управление на героя в играта. В зависимост от предпочитанието на играча може да се използват бутоните W, A, S, D или стрелките. И в двата случая стрелянето се извършва чрез space бутонът.


3. Физическата симулация

Препятствията се състоят от три слоя - външен, вътрешен и завършваща част. Вътрешният и външният слой са произволни дъги, като радиусът на външната е по-голям от този на вътрешния. Завършващата част се състои от два полукръга, разположени на краищата на вътрешния и външния слой.

	 Проверката за сблъсък на окръжности разглежда дали разстоянието от центъра на една окръжност до центъра на друга е по-малък от сбора на радиусите им.

Блъскането на обектите се състои от три части. Първата проверка разглежда случаите, в които се блъскаш отвън и то единствено в определена дъга от външната окръжност. Втората, аналогично, разглежда случаите, в които се блъскаме от вътрешната страна на създадената дъга. Третата - случаите, в които играчът се е сблъскал с някоя от завършващите окръжности. Формата на куршумите е същата като на играчите, затова и проверките са сходни.

Една от трудностите, с които се сблъскахме, е намиране на ъгъла на отражение на движещия се обект. При сблъсък обектът се отклонява по същия начин като топка в твърдо тяло с дадена/сферична/ форма.

4. Комуникация клиент-сървър
4.1. Сокети и транспортни методи

Основният елемент в една игра с няколко участника е комуникацията. Винаги когато някой извърши дейност, трябва да изпрати тази информация на сървъра, за да го предаде на останалите. Socket.io модулът ни позволява да осъществим двупосочна комуникация между сървъра и потребителя като се абстрахираме от конкретната ѝ имплементация. Има няколко възможни метода за транспорт, например WebSockets и XHR Polling, но библиотеката избира оптималния. Информацията, която се подава, представлява заглавно съобщение на пакета и данните, които ни интересуват.

4.2. Свързване със сървъра

От зареждането на Web страницата до започването на играта от потребителя се случват доста неща. Първо браузъра изпраща заявка към даден web адрес, която изисква файла index.html. Там е описано, че трябва да се изтеглят още 3 файла. Там е и нашият canvas[5](платно). Тези 3 файла са съответно socket.io/socket.io.js, client.js и game.js.

Първият съдържа всичко необходимо на клиента да създаде сокет към сървъра. Той е част от socket.io модула за NodeJS. Във втория е описана цялата комуникация със сървъра (създаване, движение и изтриване на играчи, движение на куршуми и други). Третият файл обработва получената информация, създава изображение на разположението на обектите върху картата (стени, куршуми и играчи) и го “рисува“ върху екрана чрез canvas елемента. Изпълнението им започва с питане потребителя за име и създаване на сокет към сървъра. Щом сървъра получи желаното име на играча, му праща наличните стени, куршуми и други играчи. Тогава новия потребител е готов да започне.

5. Стартиране на сървъра

За да се пусне 2сървъра са нужни 2 неща:
Инсталиран NodeJS - може да свалите от http://nodejs.org/
Браузър
Трябва през terminal (linux, mac os x) или cmd (windows) да навигирате до папката, в която се намира сървъра(server.js).

5.1. Настройка на желаното IP-то
В client.js променливата server трябва да се промени от server=“localhost”, на server=желано IP. Тя указва на client.js от къде да получава и на къде да изпраща информация. Ако ще се играе от един компютър, е желателно да се остави “localhost“.

5.2. Стартиране на сървъра
За да се стартира, трябва да напишете: “node server.js”, но без кавичките. После трябва да пуснете браузър и в адрес лентата да напишете: “localhost:5000“, отново без кавички.

6. Бъдещо развитие

Играта за сега съдържа единствено основните елементи от shooter жанра. Някои възможни и планирани добавки са чат, за да се подобри комуникацията между играчите, различни карти всяка с различни правила, и акаунт система. Чрез нея всеки играч ще може да запази резултата си, да се сравнява с останалите играчи и дори да закупува предмети (оръжия, брони и други).

Друга интересна възможност, която обмисляме, е разграничаването на играчите в класове. Всеки клас ще има специални умения, които ще го отличават от останалите. Например клас scout ще е много бърз, но със слаби оръжия. Клас spy ще може да се промъква, защото ще е невидим. Клас engineer ще може да строи различни машини, които ще могат да отбраняват територия от противници, телепортират и др. В игри които са по отбори може да има специален клас, който не може да стреля, а само да лекува останалите.

7. Заключение

Успяхме да създадем игра в която могат да се включат много хора. Те имат възможността да се надпреварват, кой ще оцелее най-дълго. Играта е проста и изчистена, но има възможност за развитие.


Библиография

[1] - http://en.wikipedia.org/wiki/JavaScript
[2] - http://nodejs.org
[3] - http://socket.io/
[4] - http://expressjs.com/
[5] - http://www.w3schools.com/tags/ref_canvas.asp

